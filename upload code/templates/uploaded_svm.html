<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='circle.css') }}">

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Success!</title>
</head>
<body>
    
    <div id="audio-spectrum" style="margin: 30px;"></div>

    <div class="buttons">

        <button class="control" id="btn-play" onclick="controlFucntion(1)" disabled>Play</button>
        <button class="control" id="btn-pause" onclick="controlFucntion(0)" disabled>Pause</button>
        <button class="control" id="btn-stop" onclick="controlFucntion(-1)" disabled>Stop</button>

    </div>


    <p style="text-align: center; font-size: 25pt; margin-top: 30px;">Prediction Results</p>

    <div class="anomaly" style="display: flex;">
      <div class="anomaly-neg" id="anomaly-neg" >    
        <div class="progress2-neg progress-moved-neg">
          <div class="progress-bar2-neg" >
          </div>                       
        </div> 
      </div>

      <div class="anomaly-pos" id="anomaly-pos" >    
        <div class="progress2-pos progress-moved-pos">
          <div class="progress-bar2-pos" >
          </div>                       
        </div> 
      </div>

    </div>
    <p style="text-align: center;">Prediction Result with an anomaly score of : <span style="color:rgb(212, 4, 4)">0.7014</span></p>

    <div id="back" class="buttons">
        <form method="back" style="padding-top: 20px;">
            <button class="goback" type = "submit">Try another Audio </button>
        </form>
    </div>


    <script src="https://unpkg.com/wavesurfer.js"></script>
    <script>

        var per_val1 = '{{per_val1}}';
        var per_val2 = '{{per_val2}}';
        
        let pos = document.getElementById("anomaly-pos")
        let neg = document.getElementById("anomaly-neg");

        pos.setAttribute("style" , "--pos: "+per_val1+"%;");
        neg.setAttribute("style", "--neg: " + per_val2+ "%;");



        var Spectrum = WaveSurfer.create({
            container: '#audio-spectrum',
            progressColor : "#03a9f4"
        });

        var file = '{{ filename }}';
        console.log(file);

        let play = document.getElementById("btn-play");
        let pause = document.getElementById("btn-pause");
        let stop = document.getElementById("btn-stop");
      

        function controlFucntion( val){
            if(val == 1){
                Spectrum.play();

                play.disabled = true;
                pause.disabled = false;
                stop.disabled = false;
            } 
            else if ( val == 0){
                Spectrum.pause();

                play.disabled = false;
                pause.disabled = true;
                stop.disabled = false;
            }

            else {
                Spectrum.stop();

                play.disabled = false;
                pause.disabled = false;
                stop.disabled = true;
            }

        }

        Spectrum.on('ready', function(){
            play.disabled = false;
        });

        Spectrum.load('../static/uploads/' + file );

        //percentage circle code:

</script>

</body>
</html>